var siteRegionCookie = "", siteCountryCookie = "", siteLanguageCookie = "", psRegionCookie = "", psCountryCookie = "", psLanguageCookie = "", siteContextLanguage = "", PSRegionLangModalExists = !1, PSRegionLangSorryModalExists = !1; function LoadModal() { var e = $(".product-lang-modal"), o = $(".product-selector-region"), a = $(".product-lang-modal-close"), n = $(".product-lang-sorry-modal"), t = $(".product-lang-sorry-modal-close"), r = $(".product-item-modal "), i = $(".product-recomm-item .img-holder"), d = $(".product-item-modal-close"), l = $(".product-item-modal-image-container .product-item-modal-image"), g = 0; o.on("click", function () { e.css("display", "block"), $(".product-modal-background").css("display", "block"), g = 1 }), a.on("click", function () { "none" != $("#ps_language_drpdwn").val() && "" != $("#token").val() || ($("#ps_language_drpdwn option").each(function () { -1 != $(this).val().indexOf(siteContextLanguage.split("-")[0]) && $("#ps_language_drpdwn").val($(this).val()) }), createCookie("PSLanguage", $("#ps_language_drpdwn").val(), 365), location.reload(!0)), e.css("display", "none"), $(".product-modal-background").css("display", "none"), g = 0 }), d.on("click", function () { r.css("display", "none"), $(".product-modal-background").css("display", "none"), g = 0 }), 1 === g && e.on("click", function (o) { o.target == e && (e.css("display", "none"), g = 0) }), t.on("click", function () { n.css("display", "none"), $(".product-modal-background").css("display", "none"), g = 0 }), i.click(function () { var e = $(this).find("img").attr("src"); $(".product-modal-background").css("display", "block"), r.css("display", "block"), l.attr("src", e), g = 1 }), $(".filter-result-table table tbody").on("click", "tr", function (e) { e.preventDefault(); var o = $(this).find("a.btn-redirect").attr("href"); window.location.href = o }) } function RegionandCountryMap() { (siteRegionCookie = decodeURI(readCookie("RegionTitle")), siteCountryCookie = decodeURI(readCookie("CountryName")), siteLanguageCookie = readCookie("SiteLanguage"), psCountryCookie = decodeURI(readCookie("PSCountry")), psRegionCookie = decodeURI(readCookie("PSRegion")), psLanguageCookie = decodeURI(readCookie("PSLanguage")), RegionComparewithPS(siteRegionCookie, psRegionCookie), "null" == psCountryCookie) && createCookie("PSCountry", "united states" == siteCountryCookie.toLowerCase() ? "USA" : siteCountryCookie.toLowerCase(), 365); if ("null" == psLanguageCookie || "none-undefined" == psLanguageCookie || "undefined" == psLanguageCookie) { null != readCookie("langval") && "null" != readCookie("langval") ? createCookie("PSLanguage", readCookie("langval"), 365) : null != readCookie("temp") && "null" != readCookie("temp") ? createCookie("PSLanguage", readCookie("temp"), 365) : createCookie("PSLanguage", siteLanguageCookie, 365); var e = readCookie("PSLanguage"); if (null != e && "null" != e) { var o = e.split("-"); partsFirst = o[0]; var a = (o = o[1]).toUpperCase(), n = !1; switch (a) { case "CA": case "US": case "GB": n = !0 }n || ("en-mx" == e.toLowerCase() && "MX" == a ? a = "US" : "es-mx" == e.toLowerCase() && "MX" == a ? a = "XL" : "en-cn" == e.toLowerCase() && "CN" == a ? a = FallbackLanConcat(partsFirst + "-") : "zh-cn" == e.toLowerCase() && "CN" == a || (a = FallbackLanConcat(partsFirst + "-"))), createCookie("PSLanguage", e = partsFirst + "-" + a, 365) } } } function FallbackLanConcat(e) { switch (e) { case "de-": return "DE"; case "en-": return "GB"; case "fr-": return "CA"; case "es-": return "XL"; case "ru-": return "RU"; default: return e } } function RegionComparewithPS(e, o) { var a = null == readCookie("PSLanguage") || "null" == readCookie("PSLanguage"), n = null == readCookie("PSCountry") || "null" == readCookie("PSCountry"), t = 0 != $("#ps_country_drpdwn option[value=" + e + "]").length; if (PSRegionLangModalExists && !t) { var r = 0 != $("#ps_country_sorry_drpdwn option[value=" + o + "]").length, i = readCookie("temp"); if (null == i || "null" == i) if ("russia-and-commonwealth-of-independent-states" == readCookie("RegionTitle").toLowerCase()) -1 == (l = readCookie("SiteLanguage")).indexOf("de-") && -1 == l.indexOf("fr-") || ShowPSRegionLangSorryModal(); else if ("europe" == readCookie("RegionTitle").toLowerCase()) { -1 != (l = readCookie("SiteLanguage")).indexOf("ru-") && ShowPSRegionLangSorryModal() } else { var d = readCookie("CountryName"); d = (d = "united%20states" == d.toLowerCase() ? "USA" : d).replace(/\%20/g, ""), PSRegionLangSorryModalExists && (r || 0 == $("#ps_country_sorry_drpdwn option[value=" + d + "]").length) && ShowPSRegionLangSorryModal() } if ("asia" == readCookie("RegionTitle").toLowerCase()) { var l = readCookie("SiteLanguage"); "zh-CN" != siteContextLanguage && "en-CN" != siteContextLanguage || -1 == l.indexOf("en-CA") || (a ? ShowPSRegionLangModal("China") : HidePSRegionLangModal()) } else if ("north-america" == readCookie("RegionTitle").toLowerCase()) { l = readCookie("SiteLanguage"); ("fr-CA" == siteContextLanguage || "en-US" == siteContextLanguage || n) && (a ? (-1 != siteContextLanguage.indexOf("-CA") ? ShowPSRegionLangModal("Canada") : ShowPSRegionLangModal("USA"), "en-CA" == siteContextLanguage && location.reload(!0)) : HidePSRegionLangModal()) } else if ("europe" == readCookie("RegionTitle").toLowerCase()) { l = readCookie("SiteLanguage"); -1 == siteContextLanguage.indexOf("en-") && -1 == siteContextLanguage.indexOf("fr-") && -1 == siteContextLanguage.indexOf("de-") && -1 == siteContextLanguage.indexOf("es-ES") || -1 == l.indexOf("en-CA") ? -1 != siteContextLanguage.indexOf("ru-") && -1 != l.indexOf("en-CA") && a && ShowPSRegionLangSorryModal() : a ? ShowPSRegionLangModal("Europe") : HidePSRegionLangModal() } else if ("latin-america-and-the-caribbean" == readCookie("RegionTitle").toLowerCase()) { l = readCookie("SiteLanguage"); "en-MX" != siteContextLanguage && "es-MX" != siteContextLanguage || -1 == l.indexOf("en-CA") ? a && -1 != l.indexOf("en-CA") && ShowPSRegionLangSorryModal() : a ? ShowPSRegionLangModal("Mexico") : HidePSRegionLangModal() } else if ("russia-and-commonwealth-of-independent-states" == readCookie("RegionTitle").toLowerCase()) { l = readCookie("SiteLanguage"); -1 == siteContextLanguage.indexOf("en-") && -1 == siteContextLanguage.indexOf("ru-") || -1 == l.indexOf("en-CA") ? (-1 != siteContextLanguage.indexOf("de-") || -1 != siteContextLanguage.indexOf("fr-") && -1 != l.indexOf("en-CA")) && a && ShowPSRegionLangSorryModal() : a ? ShowPSRegionLangModal("Russia") : HidePSRegionLangModal() } } else $("#ps_language_drpdwn").val(i) } function SelectDefaultLanguage(e) { $("#ps_language_drpdwn").val(e) } function SetDefaultCountry(e) { if (null != e && null != e && "" != e) { var o = a = "united states" == e.toLowerCase() ? "USA" : e; o = "Usa" == (o = o.toLowerCase().replace(/\b[a-z]/g, function (e) { return e.toUpperCase() })) ? "USA" : o, $("#ps_country_drpdwn option[value=" + o + "]").attr("selected", "selected"), $("#ps_country_drpdwn").trigger("change") } else { var a = "united states" == siteRegionCookie.toLowerCase() ? "USA" : siteRegionCookie.toLowerCase(); $("#ps_country_drpdwn option[value=" + a + "]").attr("selected", "selected") } } function EnableDropdowns(e) { var o = e.toLowerCase().split(","); $(".dropdown-list").find("label").each(function () { for (var e = 0; e < o.length; e++)o[e].trim() === $(this).attr("for").toLowerCase() && ($(this).removeAttr("style"), $(this).next().prop("disabled", !1), $(this).next().removeAttr("style")) }) } function ShowPSRegionLangModal(e) { $(".product-lang-modal").css("display", "block"), $(".product-modal-background").css("display", "block"), isPsOverlay = 1, $("#ps_country_drpdwn").val(e), UpdatePSRegionLanguage(e) } function ShowPSRegionLangSorryModal() { $(".product-lang-sorry-modal").css("display", "block"), $(".product-modal-background").css("display", "block"), isPsOverlay = 1, UpdatePSSorryRegionLanguage($("#ps_country_sorry_drpdwn").children("option:selected").val()) } function HidePSRegionLangModal() { $(".product-lang-modal").css("display", "none"), $(".product-modal-background").css("display", "none"), isPsOverlay = 0 } function UpdatePSRegionLanguage(e) { $("#ps_language_drpdwn").find("option").remove().end().append('<option value="none">Select your language</option>'), $.ajax({ type: "GET", dataType: "json", data: { countryName: e }, url: "/sitecoreapi/productselector/GetSelectedLanguages", success: function (e) { if (e.length > 0) { var o = $("#ps_language_drpdwn"); if ($("#ps_language_drpdwn option").length < 2) for (var a = 0; a < e.length; a++)o.append($("<option>", { value: e[a].LanguageCode, text: e[a].LanguageName }, "</option>")); SelectDefaultLanguage(readCookie("PSLanguage")), createPSLanguageCookie(), createPSCountryCookie(), createPSRegionCookie() } (null != readCookie("langval") && "null" != readCookie("langval") ? $("#ps_language_drpdwn").val(readCookie("langval")) : null != readCookie("temp") && "null" != readCookie("temp") && $("#ps_language_drpdwn").val(readCookie("temp")), null != readCookie("PSLanguage") && "null" != readCookie("PSLanguage") || $("#ps_language_drpdwn").val("none"), 2 == $("#ps_language_drpdwn").find("option").length) && ($("#ps_language_drpdwn").attr("style", "visibility: hidden"), createCookie("PSLanguage", $("#ps_language_drpdwn").children("option:nth-child(2)").val(), 365)); "true" != localStorage.getItem("hide") && 2 == $("#ps_language_drpdwn").find("option").length ? ($("#ps_language_drpdwn").attr("style", "visibility: hidden"), localStorage.setItem("hide", "true"), createCookie("PSLanguage", $("#ps_language_drpdwn").children("option:nth-child(2)").val(), 365), location.reload(!0)) : 2 != $("#ps_language_drpdwn").find("option").length && ($("#ps_language_drpdwn").removeAttr("style"), localStorage.removeItem("hide")) } }) } function UpdatePSSorryRegionLanguage(e) { $("#ps_language_sorry_drpdwn").find("option").remove().end().append('<option value="none">Select your language</option>'), $.ajax({ type: "GET", dataType: "json", data: { countryName: e }, url: "/sitecoreapi/productselector/GetSelectedLanguages", success: function (e) { if (e.length > 0) { for (var o = $("#ps_language_sorry_drpdwn"), a = 0; a < e.length; a++)o.append($("<option>", { value: e[a].LanguageCode, text: e[a].LanguageName }, "</option>")); SelectDefaultLanguage(readCookie("PSLanguage")), createPSSorryLanguageCookie(), createPSSorryCountryCookie(), createPSSorryRegionCookie() } if ("true" != localStorage.getItem("sorryhide") && 2 == $("#ps_language_sorry_drpdwn").find("option").length) { $("#ps_language_sorry_drpdwn").attr("style", "visibility: hidden"), localStorage.setItem("sorryhide", "true"), localStorage.setItem("hide", "true"); var n = $("#ps_language_sorry_drpdwn").children("option:nth-child(2)").val(); createCookie("PSLanguage", n, 365), $("#ps_language_sorry_drpdwn").val(n), $("#ps_language_drpdwn").val(n), createCookie("temp", $("#ps_language_sorry_drpdwn").val(), 365), location.reload(!0) } else 2 != $("#ps_language_sorry_drpdwn").find("option").length && "Select an option" != $("#ps_country_sorry_drpdwn").val() && ($("#ps_language_sorry_drpdwn").removeAttr("style"), localStorage.removeItem("sorryhide")) } }), $("#ps_language_sorry_drpdwn").attr("style", "visibility: hidden") } function readCookie(e) { for (var o = e + "=", a = document.cookie.split(";"), n = 0; n < a.length; n++) { for (var t = a[n]; " " == t.charAt(0);)t = t.substring(1, t.length); if (0 == t.indexOf(o)) return t.substring(o.length, t.length) } return null } function eraseCookie(e) { createCookie(e, "", -1) } function createCookie(e, o, a) { if (a) { var n = new Date; n.setTime(n.getTime() + 24 * a * 60 * 60 * 1e3); var t = "; expires=" + n.toGMTString() } else t = ""; document.cookie = e + "=" + encodeURIComponent(o) + t + "; path=/" } function createPSLanguageCookie() { createCookie("PSLanguage", $("#ps_language_drpdwn").val(), 365) } function createPSSorryLanguageCookie() { createCookie("PSLanguage", $("#ps_language_sorry_drpdwn").val(), 365) } function createPSCountryCookie() { createCookie("PSCountry", $("#ps_country_drpdwn").val(), 365) } function createPSSorryCountryCookie() { createCookie("PSCountry", $("#ps_country_sorry_drpdwn").val(), 365) } function createPSRegionCookie() { createCookie("PSRegion", $("option:selected", "#ps_country_drpdwn").attr("region-name"), 365) } function createPSSorryRegionCookie() { createCookie("PSRegion", $("option:selected", "#ps_country_sorry_drpdwn").attr("region-name"), 365) } $(document).ready(function () { siteContextLanguage = $("html").attr("lang"), PSRegionLangModalExists = $("#ps_country_drpdwn").length > 0, PSRegionLangSorryModalExists = $("#ps_country_sorry_drpdwn").length > 0; var e = readCookie("PSLanguage"); if (null != e && "null" != e) { var o = e.split("-"); if (partsFirst = o[0], null != (o = o[1])) var a = o.toUpperCase(); createCookie("PSLanguage", e = partsFirst + "-" + a, 365) } PSRegionLangSorryModalExists && 0 == $("#ps_country_sorry_drpdwn option[region-name=" + readCookie("RegionTitle") + "]").length && createCookie("PSLanguage", null, 365), RegionandCountryMap(), LoadModal() }), $(document).on("click", ".country-block a", function () { if (createCookie("temp", null, 365), createCookie("langval", null, 365), "europe" == readCookie("RegionTitle").toLowerCase()) createCookie("PSCountry", readCookie("RegionTitle").toLowerCase(), 365); else if ("russia-and-commonwealth-of-independent-states" == readCookie("RegionTitle").toLowerCase()) createCookie("PSCountry", "russia", 365); else { createCookie("PSCountry", "united%20states" == readCookie("CountryName").toLowerCase() ? "USA" : readCookie("CountryName").toLowerCase(), 365) } }), $(document).on("click", ".product-selector-region", function () { var e = readCookie("PSCountry"), o = readCookie("PSLanguage"), a = readCookie("langval"); $("#ps_language_drpdwn").val(a), SetDefaultCountry(e), SelectDefaultLanguage(null != a && "null" != a ? a : o) }), $(document).on("change", "#ps_country_drpdwn", function () { UpdatePSRegionLanguage($("#ps_country_drpdwn").children("option:selected").val()) }), $(document).on("change", "#ps_country_sorry_drpdwn", function () { UpdatePSSorryRegionLanguage($("#ps_country_sorry_drpdwn").children("option:selected").val()) }), $(document).on("change", "#ps_language_drpdwn", function () { var e = $("#ps_language_drpdwn").children("option:selected").val(); if ("none" != e) { $("#ps_language_drpdwn").val(e), createCookie("langval", $("#ps_language_drpdwn").val(), 365); var o = readCookie("langval"); $("#ps_language_drpdwn").val(o), createCookie("PSLanguage", $("#ps_language_drpdwn").val(), 365), location.reload(!0) } }), $(document).on("change", "#ps_language_sorry_drpdwn", function () { var e = $("#ps_language_sorry_drpdwn").children("option:selected").val(); "none" != e && ($("#ps_language_sorry_drpdwn").val(e), $("#ps_language_drpdwn").val(e), createCookie("temp", $("#ps_language_sorry_drpdwn").val(), 365), createCookie("PSLanguage", $("#ps_language_sorry_drpdwn").val(), 365), location.reload(!0)) });